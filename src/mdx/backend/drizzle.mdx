# Drizzle ORM

## Installation

```bash
npm install drizzle-orm pg
npm install -D drizzle-kit
```

## Basic Setup

```typescript
import { drizzle } from 'drizzle-orm/node-postgres'
import { pgTable, serial, text, timestamp } from 'drizzle-orm/pg-core'
import { Pool } from 'pg'

// Define your schema
export const users = pgTable('users', {
  id: serial('id').primaryKey(),
  name: text('name').notNull(),
  createdAt: timestamp('created_at').defaultNow()
})

// Create a PostgreSQL connection
const pool = new Pool({
  host: 'localhost',
  port: 5432,
  user: 'postgres',
  password: 'password',
  database: 'test',
})

// Create your database instance
const db = drizzle(pool)
```

## Tips and Best Practices

### Schema Design
- Use meaningful table and column names
- Implement proper relationships between tables
- Consider using enums for fixed value sets

### Migration Management
- Keep migrations in version control
- Test migrations in development environment first
- Create backup before running migrations in production

### Query Optimization
- Use prepared statements for repeated queries
- Implement proper indexing strategy
- Use transactions when necessary

## Common Operations

```typescript
// Insert data
const newUser = await db.insert(users).values({
  name: 'John Doe'
}).returning()

// Query data
const allUsers = await db.select().from(users)

// Update data
const updatedUser = await db
  .update(users)
  .set({ name: 'Jane Doe' })
  .where(eq(users.id, 1))
  .returning()

// Delete data
const deletedUser = await db
  .delete(users)
  .where(eq(users.id, 1))
  .returning()
```

## Relations and Joins

```typescript
const posts = pgTable('posts', {
  id: serial('id').primaryKey(),
  title: text('title').notNull(),
  userId: integer('user_id').references(() => users.id)
})

// Query with join
const usersWithPosts = await db
  .select()
  .from(users)
  .leftJoin(posts, eq(users.id, posts.userId))
```